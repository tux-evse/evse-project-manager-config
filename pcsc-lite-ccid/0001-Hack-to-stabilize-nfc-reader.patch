From 81676116b8e36fe01334f456cb91fc34b34b5536 Mon Sep 17 00:00:00 2001
From: Ronan Le Martret <ronan.lemartret@iot.bzh>
Date: Wed, 28 Feb 2024 14:30:50 +0100
Subject: [PATCH] Hack to stabilize nfc reader

* In some case (unstable) we've got a problem on the acr122u reader.
 Remove the timeout on "libusb_bulk_transfer" solve the problem.
---
 PCSC-contrib   | 2 +-
 src/ccid_usb.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/PCSC-contrib b/PCSC-contrib
index deebf6f..9ca8c8a 160000
--- a/PCSC-contrib
+++ b/PCSC-contrib
@@ -1 +1 @@
-Subproject commit deebf6fca223d799b19de3c359697bed7b694bf0
+Subproject commit 9ca8c8a06840325c7f8122e97068407ee96a8618
diff --git a/src/ccid_usb.c b/src/ccid_usb.c
index ff157a1..9858cba 100644
--- a/src/ccid_usb.c
+++ b/src/ccid_usb.c
@@ -1060,7 +1060,7 @@ read_again:
 	{
 		rv = libusb_bulk_transfer(usbDevice[reader_index].dev_handle,
 			usbDevice[reader_index].bulk_in, buffer, *length,
-			&actual_length, usbDevice[reader_index].ccid.readTimeout);
+			&actual_length, 0);
 
 		if (rv < 0)
 		{
-- 
2.43.2

